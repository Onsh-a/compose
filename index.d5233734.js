function t(t){if(1===t)return"root";if(!+t)return NaN;let e=String(+t).split(""),s=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],i="",r=3;for(;r--;)i=(s[+e.pop()+10*r]||"")+i;return Array(+e.join("")+1).join("M")+i}class e{patterns={maj:[0,4,7],m:[0,3,7],dim:[0,3,6],aug:[0,4,8]};isSharp=!0;diatonicPatterns={major:["","m","m","","","m","dim"],natural_minor:["m","dim","","m","m","",""],harmonic_minor:["m","dim","aug","m","","","dim"],melodic_minor:["m","m","aug","","","dim","dim"]};_notes={sharp:["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],flat:["C","D♭","D","E♭","E","F","F♭","G","A♭","A","B♭","B"]};_getNotes(){return this._notes[this.isSharp?"sharp":"flat"]}setIsSharp(t){this.isSharp=t}calcChord(t){const e=this.getChordType(t),s=this._getNotes().indexOf(this.getNote(t)),i=this._getNotes().slice(s).concat(this._getNotes().slice(0,s));return this.patterns[e].map((t=>i[t]))}getChordType(t){let e=t.split("");return e=e.filter((t=>/[a-zA-Z]+/.test(t))),e.shift(),e.join("")||"maj"}getNote(t){return t.split("").includes("#")?`${t[0]}#`:`${t[0]}`}calcDiatonic(t,e){return this.diatonicPatterns[e].map(((e,s)=>`${t[s]}${e}`))}}class s{constructor(t,e=!0){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.isSharp=e}_notes={sharp:["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],flat:["C","D♭","D","E♭","E","F","F♭","G","A♭","A","B♭","B"]};pianoKeyboard=[!0,!1,!0,!1,!0,!0,!1,!0,!1,!0,!1,!0];xCoordinate=15;yCoordinate=15;preparedKeysData(t){return this._getNotes().concat(this._getNotes()).map((e=>({isActive:t.includes(e),note:e,isRoot:e===t[0]})))}_getNotes(){return this._notes[this.isSharp?"sharp":"flat"]}setIsSharp(t){this.isSharp=t}renderKeyboard(t){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvas.width=900,this.canvas.height=380,this.ctx.scale(2,2),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),t=this.preparedKeysData(t);let e=this.xCoordinate,s=this.yCoordinate;const i=this.pianoKeyboard.concat(this.pianoKeyboard);i.forEach(((r,o)=>{const a=t[o].isActive;if(this.ctx.lineWidth=1,this.ctx.strokeStyle="black",r?(this.ctx.fillStyle="white",this.ctx.globalCompositeOperation="destination-over",this.ctx.fillRect(e,s,30,160),this.ctx.strokeRect(e,s,30,160)):(this.ctx.fillStyle="black",this.ctx.globalCompositeOperation="source-over",this.ctx.fillRect(e,s,22,120),this.ctx.strokeRect(e,s,22,120)),a){const s=e+(r?30:22)/2-(r?8:6),i=r?145:115,a=r?20:14;this.ctx.globalCompositeOperation="source-over",this.ctx.fillStyle=t[o].isRoot?"gold":"#26CC26",this.ctx.fillRect(s,i,r?16:12,a),this.ctx.beginPath(),this.ctx.font="8px Nunito, sans-serif",this.ctx.fillStyle="black";const c=t[o].note.length<2?s+5:s;this.ctx.fillText(t[o].note,c,i+a/2+4)}!0===r&&(e+=20),!1===r&&!1!==i[o+1]&&(e+=10),4!==o&&11!==o&&16!==o||(e+=10)}))}}class i{constructor(t,e=!0){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.isSharp=e}_guitarStrings={sharp:[["E","F","F#","G","G#","A","A#","B","C","C#","D","D#","E","F","F#"],["B","C","C#","D","D#","E","F","F#","G","G#","A","A#","B","C","C#"],["G","G#","A","A#","B","C","C#","D","D#","E","F","F#","G","G#","A"],["D","D#","E","F","F#","G","G#","A","A#","B","C","C#","D","D#","E"],["A","A#","B","C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],["E","F","F#","G","G#","A","A#","B","C","C#","D","D#","E","F","F#"]],flat:[["E","F","G♭","G","A♭","A","B♭","B","C","D♭","D","E♭","E","F","G♭"],["B","C","D♭","D","E♭","E","F","G♭","G","A♭","A","B♭","B","C","D♭"],["G","A♭","A","B♭","B","C","D♭","D","E♭","E","F","G♭","G","A♭","A"],["D","E♭","E","F","G♭","G","A♭","A","B♭","B","C","D♭","D","E♭","E"],["A","B♭","B","C","D♭","D","E♭","E","F","G♭","G","A♭","A","B♭","B"],["E","F","G♭","G","A♭","A","B♭","B","C","D♭","D","E♭","E","F","G♭"]]};setIsSharp(t){this.isSharp=t}_getStrings(){return this._guitarStrings[this.isSharp?"sharp":"flat"]}notesOnString=[];isToRender=[];width=800;height=280;renderGuitar(t,e){this.scale=t,this.root=e,this.canvasGuitarSetup(),this.getNotesOnFretBoard(),this.renderGuitarNotes(this.notesOnString)}canvasGuitarSetup(){this.canvas.width=this.width,this.canvas.height=this.height,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.scale(6,6),this.ctx.globalCompositeOperation="source-over",this.ctx.lineWidth="0.4";this.ctx.strokeStyle="black",this.ctx.fillStyle="#a36f40",this.ctx.strokeRect(8,3,120,35),this.ctx.fillRect(8,3,120,35);for(let t=2;t<=36;t+=6)this.ctx.strokeStyle="lightgrey",this.ctx.moveTo(8,3.3+t),this.ctx.lineTo(128,3.3+t),this.ctx.stroke();for(let t=8;t<=119;t+=8)this.ctx.moveTo(8+t,3),this.ctx.lineTo(8+t,38),this.ctx.stroke();this.ctx.font="4px Nunito, sans-serif",this.ctx.fillStyle="white",this.ctx.fillText("5",43,43),this.ctx.fillText("7",59,43),this.ctx.fillText("9",75,43),this.ctx.fillText("12",97.5,43)}getNotesOnFretBoard(){for(let t=0;t<6;t++)this.notesOnString[t]=this._getStrings()[t].filter((t=>this.scale.includes(t))),this.isToRender[t]=this._getStrings()[t].map((e=>this.notesOnString[t].includes(e)))}renderGuitarNotes(){let t=-.5;for(let e=0;e<6;e++){let s=-4;t+=6;for(let i=0;i<15;i++)!0!==this.isToRender[e][i]||(this.ctx.beginPath(),this.ctx.arc(s+8,t,2,0,2*Math.PI),this.ctx.fillStyle=this._getStrings()[e][i]!==this.root?"#26CC26":"gold",this.ctx.fill(),this.ctx.beginPath(),this.ctx.font="3px Nunito, sans-serif",this.ctx.fillStyle="black",this.ctx.fillText(this._getStrings()[e][i],s+8-1,t+1)),s+=8}}}class r{constructor(t,e,s=!0){this.root=t,this.scaleType=e,this.isSharp=s,this.scalePattern=this.scalePatterns[e]}_notes={sharp:["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],flat:["C","D♭","D","E♭","E","F","G♭","G","A♭","A","B♭","B"]};scalePatterns={major:[0,2,4,5,7,9,11],natural_minor:[0,2,3,5,7,8,10],harmonic_minor:[0,2,3,5,7,8,11],melodic_minor:[0,2,3,5,7,9,11]};setRoot(t){this.root=t}setScaleType(t){this.scaleType=t,this.scalePattern=this.scalePatterns[t]}setIsSharp(t){this.isSharp=t}getNotes(){return this.isSharp?this._notes.sharp:this._notes.flat}getScale(){const t=this.getNotes(),e=t.indexOf(this.root),s=t.slice(e).concat(t.slice(0,e));return this.scalePattern.map((t=>s[t]))}}function o(){const t=document.querySelectorAll(".selected"),e=document.querySelectorAll(".select-box__option");t.forEach((t=>{t.addEventListener("click",(()=>{t.parentNode.querySelector(".select-box__options").classList.toggle("active"),document.addEventListener("click",s)}))}));const s=t=>{t.target.closest(".select-box")||(document.querySelector(".select-box__options.active").classList.remove("active"),document.removeEventListener("click",s))};e.forEach((t=>{t.addEventListener("click",(t=>{const e=t.target.closest(".select-box"),i=e.dataset.type,r=t.target.closest(".select-box__option"),o=r.dataset[i];e.querySelector(".selected").innerHTML=r.querySelector("label").innerHTML,r.parentNode.classList.remove("active");const a=new CustomEvent("changeSettings",{detail:{eventType:i,value:o}});document.removeEventListener("click",s),document.dispatchEvent(a)}))}))}document.addEventListener("DOMContentLoaded",(()=>{const a=document.querySelector(".canvas"),c=document.querySelector(".chord__applicature");o();const n=new s(c),l=new s(a),h=new i(a),d=new e,p=new r("C","major");window.scaleClass=p;let u="guitar",g=[];const x=document.querySelector(".select-root"),S=document.querySelector(".progression__chords-diatonic"),C=document.querySelector(".progression__chords-basic");x.addEventListener("click",(t=>{const e=t.target;e.classList.contains("select-root__item")&&p.setRoot(e.innerText),e.classList.contains("select-root__alter")&&(p.setIsSharp("sharp"===e.innerText.toLowerCase()),x.querySelectorAll(".select-root__item").forEach(((t,e)=>{t.innerText=p.getNotes()[e],t.dataset.root=p.getNotes()[e].toLowerCase()}))),f(),m()})),document.addEventListener("changeSettings",(t=>{if("instrument"===t.detail.eventType)return u=t.detail.value,void m();p.setScaleType(t.detail.value),m()}));const m=()=>{g=p.getScale(),n.renderKeyboard(d.calcChord(p.root)),v(g),y(d.calcDiatonic(g,p.scaleType)),E(),l.setIsSharp(p.isSharp),n.setIsSharp(p.isSharp),d.setIsSharp(p.isSharp),h.setIsSharp(p.isSharp),A(g,u)},f=()=>{x.querySelectorAll(".active").forEach((t=>t.classList.remove("active")));let t=x.querySelector(`[data-root='${p.root.toLocaleLowerCase()}']`);t||(p.setRoot(p.getNotes()[0]),t=x.querySelector(`[data-root='${p.root.toLocaleLowerCase()}']`)),t.classList.add("active"),x.querySelector(`[data-is-${p.isSharp?"sharp":"flat"}]`).classList.add("active")},v=t=>{document.querySelectorAll(".scale__notes td:not(:first-child)").forEach(((e,s)=>e.innerText=t[s]))},y=e=>{let s="",i="";e.forEach(((e,r)=>{const o=t(r+1);[0,3,4].includes(r)?s+=`<span>${o}: </span><span class="chord">${e}</span><br>`:i+=`<span>${o}: </span><span class="chord">${e}</span><br>`})),S.innerHTML=s,C.innerHTML=i},E=()=>{const t=document.querySelectorAll(".progression .chord"),e=document.querySelector(".chord__title");t.forEach((t=>{t.addEventListener("click",(t=>{const s=d.calcChord(t.target.innerText);e.innerText=`Chord ${t.target.innerText}`,n.renderKeyboard(s)}))}))},A=(t,e)=>{"piano"===e?l.renderKeyboard(g):"guitar"===e&&h.renderGuitar(g,p.root)};m()}));
//# sourceMappingURL=index.d5233734.js.map
